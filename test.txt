curl -H "Authorization: token TOKEN_GITHUB" -o "$filename" -L "https://maven.pkg.github.com/rakbank-internal/IBPS-Deployment/$filename"
===================


Search logs
3s
2s
0s
0s
0s
Run cd /ansible/GITHUB_RUNNER/actions-runner10/_work/IBPS-Deployment/IBPS-Deployment
  

PLAY [target_jb] ***************************************************************

TASK [Gathering Facts] *********************************************************
ok: [ANT3CASAPPS01]

TASK [Execute deployment script] ***********************************************
fatal: [ANT3CASAPPS01]: FAILED! => {"changed": true, "cmd": "pwd\n/bin/bash -c './deploy.sh'\n", "delta": "0:00:00.313484", "end": "2024-01-10 12:27:39.001432", "msg": "non-zero return code", "rc": 127, "start": "2024-01-10 12:27:38.687948", "stderr": "/bin/bash: ./deploy.sh: No such file or directory", "stderr_lines": ["/bin/bash: ./deploy.sh: No such file or directory"], "stdout": "/home/itdevtra", "stdout_lines": ["/home/itdevtra"]}
...ignoring

TASK [Rollback on Deployment Failure] ******************************************
fatal: [ANT3CASAPPS01]: FAILED! => {"changed": true, "cmd": "pwd\n/bin/bash -c './rollback.sh change.log'\n", "delta": "0:00:00.314749", "end": "2024-01-10 12:27:39.665616", "msg": "non-zero return code", "rc": 127, "start": "2024-01-10 12:27:39.350867", "stderr": "/bin/bash: ./rollback.sh: No such file or directory", "stderr_lines": ["/bin/bash: ./rollback.sh: No such file or directory"], "stdout": "/home/itdevtra", "stdout_lines": ["/home/itdevtra"]}

PLAY RECAP *********************************************************************
ANT3CASAPPS01              : ok=2    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   

Error: Process completed with exit code 2.

====================

- hosts: '{{ target }}'
  become: yes
  become_user: itdevtra
  gather_facts: yes
  tasks:
    - name: Execute deployment script
      shell: "/bin/bash -c '{{ destination }}/deploy.sh'"
      args:
        chdir: '{{ destination }}'
      register: deploy_result
      ignore_errors: yes

    - name: Rollback on Deployment Failure
      shell: "/bin/bash -c '{{ destination }}/rollback.sh change.log'"
      args:
        chdir: '{{ destination }}'
      when: deploy_result|failed
=========================
5s
3s
0s
0s
0s
Run cd /ansible/GITHUB_RUNNER/actions-runner10/_work/IBPS-Deployment/IBPS-Deployment
  cd /ansible/GITHUB_RUNNER/actions-runner10/_work/IBPS-Deployment/IBPS-Deployment
  ansible-playbook -b --extra-vars "target=target_jb destination=$destination" ./playbook/IBPS-deployment.yml
  shell: /usr/bin/bash -e {0}
  env:
    TOKEN_GITHUB: 
  

PLAY [target_jb] ***************************************************************

TASK [Gathering Facts] *********************************************************
ok: [ANT3CASAPPS01]

TASK [Execute deployment script] ***********************************************
fatal: [ANT3CASAPPS01]: FAILED! => {"changed": true, "cmd": "/bin/bash -c '/deploy.sh'", "delta": "0:00:00.326185", "end": "2024-01-10 12:33:36.031091", "msg": "non-zero return code", "rc": 127, "start": "2024-01-10 12:33:35.704906", "stderr": "/bin/bash: /deploy.sh: No such file or directory", "stderr_lines": ["/bin/bash: /deploy.sh: No such file or directory"], "stdout": "", "stdout_lines": []}
...ignoring

TASK [Rollback on Deployment Failure] ******************************************
fatal: [ANT3CASAPPS01]: FAILED! => {"changed": true, "cmd": "/bin/bash -c '/rollback.sh change.log'", "delta": "0:00:00.311306", "end": "2024-01-10 12:33:36.731519", "msg": "non-zero return code", "rc": 127, "start": "2024-01-10 12:33:36.420213", "stderr": "/bin/bash: /rollback.sh: No such file or directory", "stderr_lines": ["/bin/bash: /rollback.sh: No such file or directory"], "stdout": "", "stdout_lines": []}

PLAY RECAP *********************************************************************
ANT3CASAPPS01              : ok=2    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   

Error: Process completed with exit code 2.
============

- hosts: '{{ target }}'
  become: yes
  become_user: itdevtra
  gather_facts: yes
  tasks:
    - name: Execute deployment script
      shell: "/bin/bash -c '{{ github.workspace }}/path/to/deploy.sh'"
      register: deploy_result
      ignore_errors: yes

    - name: Rollback on Deployment Failure
      shell: "/bin/bash -c '{{ github.workspace }}/path/to/rollback.sh change.log'"
      when: deploy_result|failed
===========


