publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
        }
    }
    repositories {
        maven {
            name = 'GitHubPackages'
            url = uri("https://maven.pkg.github.com/your-organization/your-repository")
            credentials {
                username = project.findProperty("gpr.user") ?: System.getenv("USERNAME_GITHUB")
                password = project.findProperty("gpr.token") ?: System.getenv("TOKEN_GITHUB")
            }
        }
    }
}

tasks.register('publishToGitHubPackages') {
    dependsOn('publish')
}

task publish {
    dependsOn 'clean', 'build'

    doLast {
        def releaseVersion = project.hasProperty("buildVersion") ? project.buildVersion : "1.0.0"
        def packageName = "com.rakbank.infosys.lib.release-${project.name}"

        project.publishing.publications.mavenJava.pom.groupId = 'com.rakbank.infosys.lib'
        project.publishing.publications.mavenJava.pom.artifactId = packageName
        project.publishing.publications.mavenJava.pom.version = releaseVersion
        project.version = releaseVersion

        // ... other configurations ...

        // Publish the artifact with the modified package name
        project.publishing.publications.mavenJava.artifacts {
            artifact(project.jar) {
                classifier 'release'
            }
        }

        project.publishing.publications.mavenJava.artifacts {
            artifactId packageName
        }

        // ... other publishing configurations ...
    }
}
