- name: Run Ansible Playbook
  env:
    TOKEN_GITHUB: ${{ secrets.TOKEN_GITHUB }}
  run: |
    cd ${{ github.workspace }}
    ansible-playbook -b --extra-vars "target=target_jb destination=${{ github.workspace }}" ./playbook/IBPS-deployment.yml
==================
- hosts: '{{ target }}'
  become: yes
  become_user: itdevtra
  gather_facts: yes
  tasks:
    - name: Execute deployment script
      shell: "/bin/bash -c '{{ destination }}/deploy.sh'"
      register: deploy_result
      ignore_errors: yes

    - name: Rollback on Deployment Failure
      shell: "/bin/bash -c '{{ destination }}/rollback.sh change.log'"
      when: deploy_result|failed
