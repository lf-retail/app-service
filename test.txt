  Create-Database-CI:
    if: ${{ github.event.inputs.database =='true' }}
    environment: DEV
    name: Database-CI-Setup
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
      issues: write
      repository-projects: write
      
    steps:
    - name: Get Token
      id: get-workflow-token
      uses: peter-murray/workflow-application-token-action@v2
      with:
        application_id: 403159
        application_private_key: ${{ secrets.DEVOPSTOKEN_DEH }}

        
    - name: Display selected inputs
      run: |
        echo "Selected Release Version: ${{ github.event.inputs.releaseVersion }}"
        echo "Selected Repository: ${{ github.event.inputs.choice }}"
        
    - name: Checkout selected repository
      uses: actions/checkout@v3
      with:
        repository: ${{ github.event.inputs.choice }}
        ref: 'dev'
        token: ${{ steps.get-workflow-token.outputs.token }}

    - name : Create Application Release Branch 
      run: |
        RELEASE_BRANCH_NAME=release/r-${{ github.event.inputs.releaseVersion }}
        git checkout -b $RELEASE_BRANCH_NAME
        git push --set-upstream origin $RELEASE_BRANCH_NAME
      env:
        token: $GITHUB_TOKEN         
      

  Database-CI:
    name: Database-CI
    needs: Create-Database-CI
    uses: Rakbank-DEH-Onboarding/RetailOnboarding-DB/.github/workflows/database-ci.yml@dev
    secrets: inherit
    with:
      repoName: ${{ github.event.inputs.choice }}
      branchName: $RELEASE_BRANCH_NAME

  Database-Deploy-Dev:
    needs: Database-CI
    environment: DEV
    name: Database Deployment DEV
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v2
      - name: deploy App
        run: |
          echo " running App deployment now "
          
  Database-Deploy-UAT:
    needs: Database-Deploy-Dev
    uses: Rakbank-DEH-Onboarding/RetailOnboarding-DB/.github/workflows/main.yml@main
    with:
      repoName: ${{ github.event.inputs.choice }}
      branchName: $RELEASE_BRANCH_NAME
      token: $GITHUB_TOKEN 

  Database-Deploy-PROD:
    needs: Database-Deploy-UAT
    environment: PROD
    name: Database Deployment PROD
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v2
      - name: deploy App
        run: |
          echo " running App deployment now "
          
  Datbase-deploy-DR:
    needs: Database-Deploy-PROD
    environment: DR
    name: Database Deployment DR
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v2
      - name: deploy App
        run: |
          echo " running App deployment now "
==================================================

ibps_server: 10.15.13.148:9043
github_token: "{{ lookup('env', 'TOKEN_GITHUB') }}"
release_version: "{{ lookup('env', 'RELEASE_VERSION') }}"
zip_file_url: "https://maven.pkg.github.com/rakbank-internal/ibps-was-ansible-cd/Rak/IBPS/release/{{ lookup('env', 'RELEASE_VERSION') }}/release-{{ lookup('env', 'RELEASE_VERSION') }}.zip"
zip_file_name: "{{ zip_file_url | basename }}"
ansible_user: "itdevtra"
Profile_home: "/ibm/IBM-CAS/WebSphere/deploy_script"
===========================

Subject: Request for IBPS Database Deployment Information

Dear [Recipient's Name],

I hope this email finds you well.

We are in the process of deploying the IBPS database and require some information from your end to proceed further. Below are the details we need:

Database Script: Please provide the database script required for deployment.

Server Details:

IP Address:
Destination Path:
Your prompt assistance in providing the above information would be greatly appreciated. If you have any questions or need further clarification, please don't hesitate to reach out.

Looking forward to your swift response.
