#!/bin/bash

Profile_home="$1"
zip_file_url="$2"
zip_file_name="$3"
backup_location="$4"

echo "Profile_home: $Profile_home"
echo "zip_file_url: $zip_file_url"
echo "zip_file_name: $zip_file_name"

# Remove the existing release directory if it exists
rm -rf "$Profile_home/release"

# Use unzip to extract contents into the specified directory
unzip -q "$Profile_home/$zip_file_name" -d "$Profile_home/"

# Iterate over each file in the release directory
for file_path in "$Profile_home"/release/*; do
    if [ -f "$file_path" ]; then
        # Extract the file name
        file_name=$(basename "$file_path")
        # Define paths for new deployment files and targeted location
        new_deployment_path="$Profile_home/release/$file_name"
        targeted_path="$Profile_home/installedApps/ANT2CASAPPS01Node01Cell"

        # Check if the targeted location exists
        if [ -d "$targeted_path" ]; then
            # Copy new deployment files to targeted location, overwriting if necessary
            cp -rf "$new_deployment_path" "$targeted_path"

            # Print information about the copy
            echo "Copy: $file_name - $new_deployment_path -> $targeted_path"
        else
            echo "Skipping copy of $file_name. Targeted location $targeted_path does not exist."
        fi
    fi
done
